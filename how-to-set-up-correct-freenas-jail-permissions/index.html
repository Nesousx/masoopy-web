<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>How to set up correct Freenas jail permissions - Masoopy</title><meta name=description content><meta property="og:title" content="How to set up correct Freenas jail permissions"><meta property="og:description" content="Freenas is a great software, allowing you to turn a PC into a NAS. Is it totally free and open source, which we really like.
Freenas overview Like any “market” NAS, Freenas allows you to install third party software such as bitorrent client, or newsgroups client. One of my favorite tools for downloading media (once again, make sure this is legal where you live) is actually a suite of tools based on newsgroups."><meta property="og:type" content="article"><meta property="og:url" content="https://www.masoopy.com/how-to-set-up-correct-freenas-jail-permissions/"><meta property="article:published_time" content="2017-07-30T12:14:03+02:00"><meta property="article:modified_time" content="2017-07-30T12:14:03+02:00"><meta property="og:site_name" content="Masoopy"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to set up correct Freenas jail permissions"><meta name=twitter:description content="Freenas is a great software, allowing you to turn a PC into a NAS. Is it totally free and open source, which we really like.
Freenas overview Like any “market” NAS, Freenas allows you to install third party software such as bitorrent client, or newsgroups client. One of my favorite tools for downloading media (once again, make sure this is legal where you live) is actually a suite of tools based on newsgroups."><meta name=application-name content="Masoopy"><meta name=apple-mobile-web-app-title content="Masoopy"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://www.masoopy.com/how-to-set-up-correct-freenas-jail-permissions/><link rel=prev href=https://www.masoopy.com/access-tunein-radio-with-kodi/><link rel=next href=https://www.masoopy.com/synchronize-your-media-with-kodi-trakt-plugin/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"How to set up correct Freenas jail permissions","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.masoopy.com\/how-to-set-up-correct-freenas-jail-permissions\/"},"genre":"posts","wordcount":565,"url":"https:\/\/www.masoopy.com\/how-to-set-up-correct-freenas-jail-permissions\/","datePublished":"2017-07-30T12:14:03+02:00","dateModified":"2017-07-30T12:14:03+02:00","publisher":{"@type":"Organization","name":"Denis G."},"author":{"@type":"Person","name":"Denis G."},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(''==='true'&&window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':(''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Masoopy>Masoopy</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=https://cheatsheets.masoopy.com/ rel="noopener noreferrer" target=_blank>Cheatsheets </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item language" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select id=language-select-desktop onchange="location=this.value;"><option value=/how-to-set-up-correct-freenas-jail-permissions/ selected>English</option></select>
</a><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Masoopy>Masoopy</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a class=menu-item href=https://cheatsheets.masoopy.com/ rel="noopener noreferrer" target=_blank>Cheatsheets</a><a class=menu-item href=/about/>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a><a href=javascript:void(0); class=menu-item title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select onchange="location=this.value;"><option value=/how-to-set-up-correct-freenas-jail-permissions/ selected>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">How to set up correct Freenas jail permissions</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Denis G.</a></span>&nbsp;<span class=post-category>included in <a href=/categories/linux/><i class="far fa-folder fa-fw"></i>linux</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2017-07-30>2017-07-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;565 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/2021/02/freenas.png data-srcset="/images/2021/02/freenas.png, /images/2021/02/freenas.png 1.5x, /images/2021/02/freenas.png 2x" data-sizes=auto alt=/images/2021/02/freenas.png title=/images/2021/02/freenas.png></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#freenas-overview>Freenas overview</a></li><li><a href=#freenas-jail-permissions>Freenas jail permissions</a></li><li><a href=#fine-tuning>Fine tuning</a></li></ul></nav></div></div><div class=content id=content><p><a href=http://www.freenas.org/ target=_blank rel="noopener noreferrer">Freenas</a> is a great software, allowing you to turn a PC into a NAS. Is it totally free and open source, which we really like.</p><h2 id=freenas-overview>Freenas overview</h2><p>Like any “market” NAS, Freenas allows you to install third party software such as bitorrent client, or newsgroups client. One of my favorite tools for downloading media (once again, make sure this is legal where you live) is actually a suite of tools based on newsgroups. The are called:</p><ul><li>sabnzbd : it will manage download of items, restart the download, if it fails, etc. We will call it the downloader, like <a href=https://www.masoopy.com/nzbget-as-a-replacement-of-sabnzbdplus/ target=_blank rel="noopener noreferrer">nzbget</a>.</li><li>couchpotato: tell him which movie you want, and it will automatically look for it and send it to the “downloader” as soon as the movie becomes available.</li><li>sonarr : just like couchpotato, but for TV Shows.</li></ul><p>NB : I’ll try to write a more elaborate guide about those great pieces of software.</p><h2 id=freenas-jail-permissions>Freenas jail permissions</h2><p>First of all, <a href=https://forums.freenas.org/index.php?threads/how-to-giving-plugins-write-permissions-to-your-data.27273/ target=_blank rel="noopener noreferrer">thanks to this guide</a> for the starting base. Now, let’s me show you my twist.</p><p>Let’s assume you have one (or several jails) for the software mentioned above. It is a pain in the *** so set up Freenas jail permissions correctly, but I’ll help.</p><p>First of all, ssh to your Freenas server and enter the desired jail with the following commands:</p><p><code>jls sudo jexec X</code></p><p>where X is the jail’s number.</p><p>From here, check the media user uid and gid by issuing:</p><p><code>grep media /etc/passwd</code></p><p>Now you should create a media group and user from the Freenas web admin (make sure the uid / gid of this user matches the one from the jail. It should be both 816 for gid and uid. See screenshot below:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/2017/07/Capture-d%E2%80%99e%CC%81cran-2017-07-30-a%CC%80-13.57.21.png data-srcset="/images/2017/07/Capture-d%E2%80%99e%CC%81cran-2017-07-30-a%CC%80-13.57.21.png, /images/2017/07/Capture-d%E2%80%99e%CC%81cran-2017-07-30-a%CC%80-13.57.21.png 1.5x, /images/2017/07/Capture-d%E2%80%99e%CC%81cran-2017-07-30-a%CC%80-13.57.21.png 2x" data-sizes=auto alt=/images/2017/07/Capture-d%E2%80%99e%CC%81cran-2017-07-30-a%CC%80-13.57.21.png title='<a href="/images/2017/07/Capture-d%E2%80%99e%CC%81cran-2017-07-30-a%CC%80-13.57.21-300x300.png" rel="">Freenas jail permissions</a>'></p><p>Now, back in the jail, we will replace the regular user of a said service with the media user.</p><p>For example, if we want to make sure that couchpotato runs with the media user, we will do the following:</p><p><code>service couchpotato onestop</code><br><code>sysrc 'couchpotato_user=media'</code></p><p>Then, we have to change ownership of all the files that belong to the previous coucpotato user to the new media one.</p><p>In order to locate all those files, issue:</p><p><code>find / -user couchpotato</code></p><p><code>chown -R media:media /folder/name</code></p><p>When you think, you are done, just do a last “find” like shown before to make sure there is nothing left. Then you can start the service again</p><p><code>service couchpotato start</code></p><p>Rinse and repeat for all the desired services / jail.</p><p>NB : in case, the media user doesn’t exists in the jail, just create it.</p><p>Last but not least, add storage to you jail. This storage must be the wanted folder for example that contains all your media and it must be owned by media:media with 775 permissions.</p><h2 id=fine-tuning>Fine tuning</h2><p>Now, if you want to fine tune this, I highly advise you to add you own user to the media group from the Freenas GUI. Also make sure to have adequate permissions for groups. Something like 775 works fine and is not too insecure.</p><p>This way, you’ll still be able to browse and modify your files with your regular user.</p><p>I hope this quick & dirty guide will help you to fix Freenas jail permissions. This is quite and advanced guide, and I took many shortcut to describe the step I used to configure my server. Do not hesitate to post a comment if you need extra details.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2017-07-30</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://www.masoopy.com/how-to-set-up-correct-freenas-jail-permissions/ data-title="How to set up correct Freenas jail permissions" data-via=nesousx><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://www.masoopy.com/how-to-set-up-correct-freenas-jail-permissions/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://www.masoopy.com/how-to-set-up-correct-freenas-jail-permissions/ data-title="How to set up correct Freenas jail permissions"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://www.masoopy.com/how-to-set-up-correct-freenas-jail-permissions/><i class="fab fa-reddit fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/access-tunein-radio-with-kodi/ class=prev rel=prev title="Access Tunein Radio with Kodi"><i class="fas fa-angle-left fa-fw"></i>Access Tunein Radio with Kodi</a>
<a href=/synchronize-your-media-with-kodi-trakt-plugin/ class=next rel=next title="Synchronize your media with Kodi Trakt plugin">Synchronize your media with Kodi Trakt plugin<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.79.1">Hugo</a> | Theme - <a href=https://github.com/sunt-programator/CodeIT target=_blank rel="noopener noreferrer" title="CodeIT 0.2.10"><i class="fas fa-laptop-code fa-fw"></i>CodeIT</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">Denis G.</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>